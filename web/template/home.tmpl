{{template "layout.tmpl" .}}

{{define "content"}}
<main>
    {{if .Session.IsLoggedIn}}
<div class="create-post-container">
    <button id="createPostBtn">Create Post</button>
    <form action="/posts" method="POST" id="createPostForm" style="display: none;">
        <textarea name="content" aria-label="content" placeholder="Write something..." rows="3" required>
            {{- .CreatePostForm.Get "content" -}}
        </textarea>
        {{with .CreatePostErr}}
        <p>Could not create post: <code>{{.Error}}</code></p>
        {{end}}

        <button type="submit">Post</button>
    </form>
</div>
    {{end}}

    {{range .Posts}}
    {{template "post-article.tmpl" .}}
    {{end}}
</main>

<script>
    document.getElementById('createPostBtn').addEventListener('click', function() {
        var btn = document.getElementById('createPostBtn');
        var form = document.getElementById('createPostForm');
        btn.style.display = 'none';
        form.style.display = 'block';
    });
</script>
{{end}}
